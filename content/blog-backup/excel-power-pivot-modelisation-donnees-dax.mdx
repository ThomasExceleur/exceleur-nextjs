---
title: "Excel Power Pivot : Modelisation de Données et DAX"
date: "2024-07-02"
author: "Thomas L'Exceleur"
excerpt: "Maîtrisez Power Pivot pour la modelisation de données et le DAX."
description: "Guide complet Power Pivot pour la modelisation et les formules DAX."
category: "Power Pivot"
catégories: ["Power Pivot", "Analyse de données Excel"]
tags: ["Power Pivot", "DAX", "Modelisation", "Excel"]
---

# Power Pivot : Modelisation de Données et DAX

Power Pivot transforme Excel en outil d'analyse de données avancé.

## Activer Power Pivot

### Étapes

1. **Fichier** > **Options** > **Complements**
2. Gérer : Complements COM > **OK**
3. Cochez **Microsoft Power Pivot for Excel**

### Acceder

Onglet **Power Pivot** dans le ruban.

## Le modèle de données

### Concept

Un modèle de données est un ensemble de tables reliees entre elles.

### Avantages

- Gérer des millions de lignes
- Relations entre tables
- Formules DAX puissantes

## Ajouter des tables

### Depuis Excel

1. Sélectionnez les données
2. **Power Pivot** > **Ajouter au modèle de données**

### Depuis Power Query

Chargez vers le modèle de données.

## Créer des relations

### Vue Diagramme

1. **Power Pivot** > **Gérer**
2. **Affichage** > **Vue Diagramme**
3. Glissez les champs pour créer des relations

### Types de relations

| Type | Description |
|------|-------------|
| Un à plusieurs (*) | Le plus courant |
| Un à un | Cas spécifiques |

## Introduction au DAX

### Qu'est-ce que DAX ?

Data Analysis Expressions - langage de formules pour Power Pivot.

### Mesures vs Colonnes calculees

| Mesures | Colonnes calculees |
|---------|-------------------|
| Calculees à la volee | Calculees à l'import |
| Contexte de filtre | Contexte de ligne |
| Non stockees | Stockees dans le modèle |

## Créer une mesure

### Étapes

1. Dans Power Pivot, sélectionnez une table
2. Zone de mesure (bas de l'ecran)
3. Entrez la formule

### Syntaxe

```dax
Nom_Mesure := FONCTION(arguments)
```

## Fonctions DAX essentielles

### Agregations

```dax
Total Ventes := SUM(Ventes[Montant])
Moyenne := AVERAGE(Ventes[Montant])
Nombre := COUNT(Ventes[ID])
Distinct := DISTINCTCOUNT(Ventes[Client])
```

### CALCULATE

Modifié le contexte de filtre.

```dax
Ventes France := CALCULATE(
    SUM(Ventes[Montant]);
    Ventes[Pays]="France"
)
```

## Time Intelligence

### Fonctions temporelles

| Fonction | Description |
|----------|-------------|
| TOTALYTD | Cumul depuis début d'année |
| SAMEPERIODLASTYEAR | Meme période année précédente |
| DATEADD | Decaler une période |
| DATESYTD | Dates depuis début d'année |

### Exemples

```dax
YTD := TOTALYTD(SUM(Ventes[Montant]); Calendrier[Date])

Année Précédente := CALCULATE(
    SUM(Ventes[Montant]);
    SAMEPERIODLASTYEAR(Calendrier[Date])
)
```

## Table Calendrier

### Pourquoi ?

Nécessaire pour les calculs temporels.

### Créer une table calendrier

```dax
Calendrier = CALENDAR(DATE(2020;1;1); DATE(2025;12;31))
```

### Ajouter des colonnes

```dax
Année = YEAR(Calendrier[Date])
Mois = FORMAT(Calendrier[Date]; "MMMM")
Trimestre = "T" & QUARTER(Calendrier[Date])
```

## Utiliser dans les TCD

### Ajouter des mesures

Les mesures apparaissent dans la liste des champs du TCD.

### Avantage

Les mesures sont calculees selon le contexte du TCD.

## Bonnes pratiques

| Pratique | Description |
|----------|-------------|
| Nommage | Noms clairs et cohérents |
| Documentation | Commentez les mesures complexes |
| Performance | Évitez les colonnes calculees inutiles |
| Test | Vérifiez avec des valeurs connues |

## Erreurs courantes

| Erreur | Cause | Solution |
|--------|-------|----------|
| Valeur vide | Division par zero | Utilisez DIVIDE() |
| #ERROR | Syntaxe incorrecte | Vérifiez la formule |
| Résultat faux | Contexte mal compris | Analysez le contexte |

[Découvrir nos formations Excel](/formations-excel)
