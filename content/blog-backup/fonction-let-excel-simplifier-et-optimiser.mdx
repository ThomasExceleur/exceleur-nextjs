---
title: "Fonction LET Excel : Simplifier et Optimiser"
date: "2024-07-02"
author: "Thomas L'Exceleur"
excerpt: "Découvrez comment LET simplifie et optimise vos formules Excel."
description: "Guide pour simplifier et optimiser vos formules avec LET Excel."
category: "Excel 365"
catégories: ["Excel 365", "Formules Excel"]
tags: ["LET", "Simplification", "Optimisation", "Formules"]
---

# Fonction LET : Simplifier et Optimiser

LET transforme des formules illisibles en code clair et performant.

## Avant/Après LET

### Formule complexe sans LET

```excel
=SI(ET(RECHERCHEX(A1;B:B;C:C;0)>0;RECHERCHEX(A1;B:B;D:D;0)>MOYENNE(D:D));
  "Premium";
  SI(RECHERCHEX(A1;B:B;C:C;0)>0;"Standard";"Nouveau"))
```

### Avec LET

```excel
=LET(
  çà;RECHERCHEX(A1;B:B;C:C;0);
  freq;RECHERCHEX(A1;B:B;D:D;0);
  moy_freq;MOYENNE(D:D);
  SI(ET(çà>0;freq>moy_freq);"Premium";
    SI(çà>0;"Standard";"Nouveau"))
)
```

## Principes de simplification

### 1. Identifier les repetitions

Cherchez les memes calculs utilisés plusieurs fois.

### 2. Nommer clairement

Utilisez des noms explicites, pas x, y, z.

### 3. Decomposer par étapes

Un calcul par variable.

## Exemples de simplification

### Calcul de prix

**Avant :**
```excel
=B1*C1*(1-D1)*(1+E1)
```

**Après :**
```excel
=LET(
  prix_unitaire;B1;
  quantité;C1;
  remise;D1;
  tva;E1;
  sous_total;prix_unitaire*quantité;
  apres_remise;sous_total*(1-remise);
  total_ttc;apres_remise*(1+tva);
  total_ttc
)
```

### Analyse de texte

**Avant :**
```excel
=GAUCHE(A1;CHERCHE(" ";A1)-1)&" - "&DROITE(A1;NBCAR(A1)-CHERCHE(" ";A1;CHERCHE(" ";A1)+1))
```

**Après :**
```excel
=LET(
  texte;A1;
  pos1;CHERCHE(" ";texte);
  pos2;CHERCHE(" ";texte;pos1+1);
  prenom;GAUCHE(texte;pos1-1);
  reste;DROITE(texte;NBCAR(texte)-pos2);
  prenom&" - "&reste
)
```

## Organisation des variables

### Par ordre logique

```excel
=LET(
  ' Données sources
  données;A2:D100;

  ' Filtrage
  filtre;FILTRE(données;données[Col1]>0);

  ' Calculs
  total;SOMME(filtre);
  moyenne;MOYENNE(filtre);

  ' Résultat
  "Total: "&total&" | Moy: "&moyenne
)
```

### Par dependance

Les variables qui dependent d'autres doivent etre définies après.

## Debug avec LET

### Technique 1 : Retourner une variable intermediaire

```excel
=LET(
  à;SOMME(A:A);
  b;MOYENNE(A:A);
  c;à/b;
  b  ' Retourne b pour debug
)
```

### Technique 2 : Concatener pour voir tout

```excel
=LET(
  à;SOMME(A:A);
  b;MOYENNE(A:A);
  c;à/b;
  "à="&à&" | b="&b&" | c="&c
)
```

## Erreurs à éviter

### Noms invalides

```excel
' ERREUR : A1 est une référence
=LET(A1;10;A1*2)

' CORRECT
=LET(valeur;10;valeur*2)
```

### Noms reserves

Évitez les noms de fonctions (SOMME, SI, etc.).

### Ordre incorrect

```excel
' ERREUR : b utilisé avant définition
=LET(à;b+1;b;10;à)

' CORRECT
=LET(b;10;à;b+1;à)
```

## LET imbriqués

### Possible mais à éviter

```excel
=LET(
  x;LET(à;1;b;2;à+b);
  x*2
)
```

### Préférez une seule LET

```excel
=LET(
  à;1;
  b;2;
  x;à+b;
  x*2
)
```

## Cas pratiques metier

### Commission commerciale

```excel
=LET(
  ventes;B1;
  seuil1;5000;
  seuil2;15000;
  taux1;0,05;
  taux2;0,08;
  taux3;0,12;
  SI(ventes<=seuil1;ventes*taux1;
    SI(ventes<=seuil2;
      seuil1*taux1+(ventes-seuil1)*taux2;
      seuil1*taux1+(seuil2-seuil1)*taux2+(ventes-seuil2)*taux3
    )
  )
)
```

### Scoring client

```excel
=LET(
  çà;C1;
  freq;D1;
  anc;E1;
  score_ca;MIN(40;çà/500);
  score_freq;MIN(30;freq*5);
  score_anc;MIN(30;anc*3);
  total;score_ca+score_freq+score_anc;
  SI(total>=80;"VIP";SI(total>=50;"Premium";"Standard"))
)
```

## Bonnes pratiques

| Pratique | Description |
|----------|-------------|
| Noms clairs | prix_ht pas p |
| Une ligne par variable | Lisibilité |
| Commentaires | Dans les noms si besoin |
| Tests | Vérifiez chaque étape |

[Découvrir nos formations Excel](/formations-excel)
