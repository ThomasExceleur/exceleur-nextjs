---
title: "Débuter avec LET et LAMBDA : Simplifier les Formules Complexes"
date: "2024-07-02"
author: "Thomas L'Exceleur"
excerpt: "Guide pour débutants sûr LET et LAMBDA pour simplifier vos formules."
description: "Apprenez à simplifier vos formules complexes avec LET et LAMBDA."
category: "Excel 365"
catégories: ["Excel 365", "Formules Excel"]
tags: ["LET", "LAMBDA", "Débutant", "Formules"]
---

# Débuter avec LET et LAMBDA

Simplifiez vos formules complexes grace à ces deux fonctions revolutionnaires.

## Pourquoi LET et LAMBDA ?

### Le problème des formules complexes

```excel
=SI(RECHERCHEX(A1;B:B;C:C)>100;
  RECHERCHEX(A1;B:B;C:C)*1.1;
  RECHERCHEX(A1;B:B;C:C)*0.9)
```

Problèmes :
- RECHERCHEX execute 3 fois
- Difficile à lire
- Erreurs de modification

### La solution : LET

```excel
=LET(
  résultat;RECHERCHEX(A1;B:B;C:C);
  SI(résultat>100;résultat*1.1;résultat*0.9)
)
```

Avantages :
- Un seul calcul
- Plus lisible
- Facile à modifier

## La fonction LET

### Syntaxe

```excel
=LET(nom1;valeur1;nom2;valeur2;...;calcul_final)
```

### Règles

- Définissez d'abord les variables
- Le dernier argument est le résultat
- Les noms ne doivent pas etre des références (pas "A1")

### Exemple simple

```excel
=LET(
  x;10;
  y;5;
  x+y
)
```

Résultat : 15

## LET en pratique

### Calcul avec étapes

```excel
=LET(
  ventes;SOMME(A:A);
  couts;SOMME(B:B);
  marge;ventes-couts;
  taux;marge/ventes;
  TEXTE(taux;"0,00%")
)
```

### Éviter les repetitions

**Avant :**
```excel
=SI(ESTNA(RECHERCHEX(A1;B:B;C:C));0;RECHERCHEX(A1;B:B;C:C))
```

**Après :**
```excel
=LET(
  val;RECHERCHEX(A1;B:B;C:C;"Non trouve");
  SI(val="Non trouve";0;val)
)
```

### Formules lisibles

```excel
=LET(
  prix_ht;B1;
  quantité;C1;
  tva;0,2;
  total_ht;prix_ht*quantité;
  total_ttc;total_ht*(1+tva);
  total_ttc
)
```

## La fonction LAMBDA

### Syntaxe

```excel
=LAMBDA(param1;param2;...;expression)
```

### Concept

LAMBDA créé une fonction personnalisee que vous pouvez reutiliser.

### Exemple simple

```excel
=LAMBDA(x;x*2)
```

Créé une fonction qui double une valeur.

## Utiliser LAMBDA avec des noms

### Étape 1 : Créer la fonction

Dans le Gestionnaire de noms :
- Nom : DOUBLER
- Fait référence à : `=LAMBDA(x;x*2)`

### Étape 2 : Utiliser

```excel
=DOUBLER(5)   ' Résultat : 10
```

## LAMBDA en pratique

### Fonction de calcul TVA

```excel
Nom: TTC
Formule: =LAMBDA(ht;tva;ht*(1+tva))
```

Usage : `=TTC(100;0,2)` retourne 120

### Fonction de nettoyage

```excel
Nom: NETTOYER_TEXTE
Formule: =LAMBDA(txt;SUPPRESPACE(EPURAGE(txt)))
```

Usage : `=NETTOYER_TEXTE("  bonjour  ")` retourne "bonjour"

### Fonction avec condition

```excel
Nom: STATUT_VENTE
Formule: =LAMBDA(montant;
  SI(montant>=1000;"VIP";
    SI(montant>=500;"Premium";"Standard"))
)
```

## Combiner LET et LAMBDA

### Pour des fonctions complexes

```excel
Nom: ANALYSE_CLIENT
Formule: =LAMBDA(ventes;anciennete;
  LET(
    score_ventes;MIN(50;ventes/100);
    score_fidelite;MIN(50;anciennete*5);
    total;score_ventes+score_fidelite;
    SI(total>=80;"VIP";SI(total>=50;"Premium";"Standard"))
  )
)
```

## Exercices pour débuter

### Exercice 1 : LET basique

Créez une formule qui calcule :
- La somme de A1:A10
- La moyenne
- Affiche "Somme: X | Moyenne: Y"

### Exercice 2 : LAMBDA simple

Créez une fonction CARRE qui retourne le carre d'un nombre.

### Exercice 3 : Combinaison

Créez une fonction REMISE qui :
- Prend un prix et un pourcentage
- Calcule la remise
- Retourne le prix final

## Erreurs courantes

### LET

| Erreur | Cause | Solution |
|--------|-------|----------|
| #NOM? | Nom invalide | Évitez les noms de cellules |
| #VALEUR! | Types incompatibles | Vérifiez les données |

### LAMBDA

| Erreur | Cause | Solution |
|--------|-------|----------|
| #CALC! | Paramètrès manquants | Vérifiez le nombre de params |
| Non défini | Pas de nom | Créez un nom défini |

## Bonnes pratiques débutant

| Pratique | Description |
|----------|-------------|
| Noms explicites | Variables claires |
| Étapes simples | Un calcul par variable |
| Tests | Vérifiez chaque étape |
| Documentation | Commentez les noms |

[Découvrir nos formations Excel](/formations-excel)
