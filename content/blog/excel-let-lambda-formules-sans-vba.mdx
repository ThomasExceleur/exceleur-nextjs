---
title: "Excel LET et LAMBDA : Formules Puissantes sans VBA"
date: "2024-07-02"
author: "Thomas L'Exceleur"
excerpt: "Creez des formules avancees avec LET et LAMBDA sans programmer."
description: "Guide LET et LAMBDA pour des formules puissantes sans VBA."
category: "Excel 365"
categories: ["Excel 365", "Formules Excel"]
tags: ["LET", "LAMBDA", "Formules", "Sans VBA"]
---

# LET et LAMBDA : Formules Puissantes sans VBA

Atteignez la puissance du VBA avec de simples formules Excel.

## Pourquoi LET et LAMBDA ?

### Avant

Formules complexes, repetitives, difficiles a maintenir.

### Apres

- Code reutilisable
- Formules lisibles
- Maintenance simplifiee
- Pas besoin de macros

## La fonction LET

### Syntaxe

```excel
=LET(nom1;valeur1;[nom2;valeur2;...];calcul)
```

### Concept

Definir des variables pour simplifier les calculs.

### Exemple simple

```excel
=LET(
  x;A1*2;
  y;B1+10;
  x+y
)
```

## Avantages de LET

### Lisibilite

```excel
' Sans LET (illisible)
=SOMME.SI(A:A;CONCAT(B1;"-";C1);D:D)/NB.SI(A:A;CONCAT(B1;"-";C1))

' Avec LET (clair)
=LET(
  critere;CONCAT(B1;"-";C1);
  total;SOMME.SI(A:A;critere;D:D);
  nombre;NB.SI(A:A;critere);
  total/nombre
)
```

### Performance

Le calcul intermediaire n'est fait qu'une fois.

## La fonction LAMBDA

### Syntaxe

```excel
=LAMBDA([param1;param2;...];calcul)
```

### Concept

Creer une fonction personnalisee reutilisable.

### Exemple

```excel
=LAMBDA(x;x*1,2)
```

Fonction qui multiplie par 1,2.

## Nommer une fonction LAMBDA

### Etapes

1. **Formules** > **Gestionnaire de noms**
2. **Nouveau**
3. Nom : PrixTTC
4. Fait reference a : =LAMBDA(prix;prix*1,2)

### Utilisation

```excel
=PrixTTC(100)  ' Retourne 120
```

## Combiner LET et LAMBDA

### Fonction avec logique complexe

```excel
Nom: CATEGORIE_CLIENT
Formule:
=LAMBDA(ca;
  LET(
    seuil_vip;10000;
    seuil_premium;5000;
    SI(ca>=seuil_vip;"VIP";
      SI(ca>=seuil_premium;"Premium";"Standard"))
  )
)
```

## Fonctions a plusieurs parametres

### Definition

```excel
Nom: REMISE
Formule: =LAMBDA(prix;taux;prix*(1-taux))
```

### Utilisation

```excel
=REMISE(100;0,1)  ' Retourne 90
```

## Cas pratiques

### Calcul de TVA flexible

```excel
Nom: TTC
Formule: =LAMBDA(ht;taux;ht*(1+taux))

Usage: =TTC(100;0,2)  ' 120 pour 20%
       =TTC(100;0,055) ' 105,5 pour 5,5%
```

### Extraction de domaine email

```excel
Nom: DOMAINE_EMAIL
Formule: =LAMBDA(email;
  DROITE(email;NBCAR(email)-CHERCHE("@";email))
)
```

### Calcul d'age

```excel
Nom: AGE
Formule: =LAMBDA(naissance;
  DATEDIF(naissance;AUJOURDHUI();"y")
)
```

## LAMBDA recursif (avance)

### Concept

LAMBDA peut s'appeler elle-meme.

### Exemple : Factorielle

```excel
Nom: FACTORIELLE
Formule: =LAMBDA(n;
  SI(n<=1;1;n*FACTORIELLE(n-1))
)
```

## MAP, REDUCE, SCAN

### MAP

Applique une fonction a chaque element.

```excel
=MAP(A1:A10;LAMBDA(x;x*2))
```

### REDUCE

Reduit un tableau a une valeur.

```excel
=REDUCE(0;A1:A10;LAMBDA(acc;val;acc+val))
```

## Avantages vs VBA

| LAMBDA | VBA |
|--------|-----|
| Pas de code | Programmation |
| Portable | Peut etre bloque |
| Recalcul automatique | Execution manuelle |
| Securise | Risques macro |

## Bonnes pratiques

| Pratique | Description |
|----------|-------------|
| Noms clairs | Fonctions explicites |
| Documentation | Commentez dans le gestionnaire |
| Test | Verifiez chaque fonction |
| Partage | Classeur modele |

[Decouvrir nos formations Excel](/formations-excel)
