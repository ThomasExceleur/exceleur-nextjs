---
title: "Importer des Donnees API REST dans Excel"
date: "2024-07-02"
author: "Thomas L'Exceleur"
excerpt: "Connectez Excel a des API REST pour importer des donnees en direct."
description: "Guide pour importer des donnees depuis une API REST dans Excel."
category: "Analyse de donnees Excel"
categories: ["Analyse de donnees Excel", "Excel 365"]
tags: ["API", "REST", "Power Query", "JSON", "Import"]
---

# Importer des Donnees API REST

Connectez Excel a des sources de donnees en ligne via API.

## Qu'est-ce qu'une API REST ?

### Definition

Une API REST permet d'acceder a des donnees via des requetes HTTP (GET, POST, etc.).

### Exemples d'API

- Donnees meteo
- Taux de change
- Statistiques publiques
- Donnees d'entreprise

## Methode 1 : Power Query

### Etapes de connexion

1. **Donnees** > **Obtenir des donnees** > **A partir du web**
2. Collez l'URL de l'API
3. Power Query s'ouvre avec les donnees JSON

### Transformer le JSON

1. Convertissez en table si necessaire
2. Developpez les colonnes imbriquees
3. Selectionnez les champs utiles
4. **Fermer et charger**

### Exemple : API de taux de change

```
https://api.exchangerate-api.com/v4/latest/EUR
```

## Methode 2 : Fonction WEBSERVICE

### Syntaxe

```excel
=WEBSERVICE(url)
```

### Limites

- Retourne du texte brut
- Maximum 32767 caracteres
- Pas de parsing JSON integre

### Parser le JSON manuellement

Utilisez des fonctions texte pour extraire les valeurs :

```excel
=STXT(WEBSERVICE(A1);CHERCHE("rate\":";A1)+6;10)
```

## Authentification

### Types d'authentification

| Type | Description |
|------|-------------|
| API Key | Cle dans l'URL ou l'en-tete |
| OAuth | Token d'acces |
| Basic Auth | Utilisateur/mot de passe |

### Dans Power Query

1. **Modifier les requetes**
2. **Editeur avance**
3. Ajoutez les en-tetes d'authentification

### Exemple avec API Key

```
https://api.example.com/data?api_key=VOTRE_CLE
```

## Actualisation des donnees

### Actualisation manuelle

**Donnees** > **Actualiser tout**

### Actualisation automatique

1. Proprietes de la requete
2. **Actualiser toutes les X minutes**
3. Ou **Actualiser a l'ouverture du fichier**

## Gestion des erreurs

### Problemes courants

| Erreur | Cause | Solution |
|--------|-------|----------|
| 401 | Authentification | Verifiez les identifiants |
| 404 | URL invalide | Verifiez l'endpoint |
| 429 | Limite atteinte | Reduisez la frequence |
| Timeout | Serveur lent | Augmentez le delai |

### Dans Power Query

Utilisez try...otherwise pour gerer les erreurs :

```
= try Web.Contents(url) otherwise null
```

## Exemple complet : Donnees meteo

### Etape 1 : URL de l'API

```
https://api.open-meteo.com/v1/forecast?latitude=48.85&longitude=2.35&current_weather=true
```

### Etape 2 : Import Power Query

1. Obtenir des donnees depuis le web
2. Convertir en table
3. Developper current_weather
4. Charger dans Excel

### Etape 3 : Mise en forme

Renommez les colonnes et formatez les donnees.

## Bonnes pratiques

1. **Cachez** les cles API (ne les exposez pas)
2. **Limitez** les appels pour respecter les quotas
3. **Documentez** les sources de donnees
4. **Testez** les URL avant l'integration

## Alternatives

### Microsoft Power Automate

Pour des scenarios plus complexes avec des workflows.

### Office Scripts

Pour des automatisations programmables dans Excel Online.

[Decouvrir nos formations Excel](/formations-excel)
