---
title: "Combiner Plusieurs Fichiers avec Power Query"
date: "2024-07-02"
author: "Thomas L'Exceleur"
excerpt: "Apprenez à fusionner plusieurs fichiers Excel où CSV avec Power Query."
description: "Guide Power Query pour combiner des fichiers. Consolidation automatique."
category: "Analyse de données Excel"
catégories: ["Analyse de données Excel", "Automatisation"]
tags: ["Power Query", "Consolidation", "Fichiers", "ETL"]
---

# Combiner Plusieurs Fichiers avec Power Query

Power Query peut fusionner automatiquement plusieurs fichiers.

## Préparation

### Organiser les fichiers

1. Placez tous les fichiers dans un meme dossier
2. Assurez-vous qu'ils ont la meme structuré
3. Utilisez des noms cohérents

## Méthode : Combiner un dossier

### Étapes

1. **Données** > **Obtenir des données** > **A partir d'un fichier** > **A partir d'un dossier**
2. Sélectionnez le dossier contenant vos fichiers
3. Cliquez sûr **Combiner** > **Combiner et transformer les données**
4. Sélectionnez l'onglet où la table à combiner
5. **OK**

### Résultat

Tous les fichiers sont fusionnés en une seule table avec une colonne indiquant le fichier source.

## Types de fichiers supportes

| Type | Extension |
|------|-----------|
| Excel | .xlsx, .xls, .xlsm |
| CSV | .csv |
| Texte | .txt |
| JSON | .json |

## Personnaliser la combinaison

### Dans l'éditeur Power Query

1. Developpez la colonne **Source.Name** si besoin
2. Filtrez les lignes d'en-tête en double
3. Changez les types de données
4. Renommez les colonnes

### Ajouter une colonne source

```m
= Table.AddColumn(Source, "Fichier", each [Source.Name])
```

## Gestion des structurés différentes

### Si les colonnes varient

1. Combinez les fichiers
2. Dans Power Query, utilisez **Accueil** > **Ajouter des requêtes**
3. Gérez les colonnes manquantes avec des valeurs null

## Actualisation automatique

### Configuration

1. Clic droit sûr la requête
2. **Propriétés**
3. Cochez **Actualiser toutes les X minutes**

### Lors de l'ouverture

Cochez **Actualiser les données lors de l'ouverture du fichier**.

## Exemple pratique : Ventes mensuelles

### Structuré des fichiers

- Ventes_Janvier.xlsx
- Ventes_Fevrier.xlsx
- Ventes_Mars.xlsx

### Résultat

| Fichier | Date | Produit | Montant |
|---------|------|---------|---------|
| Ventes_Janvier.xlsx | 15/01 | A | 100 |
| Ventes_Fevrier.xlsx | 20/02 | B | 200 |

## Filtrer les fichiers

### Par extension

Dans l'éditeur :
```m
= Table.SelectRows(Source, each Text.EndsWith([Name], ".xlsx"))
```

### Par nom

```m
= Table.SelectRows(Source, each Text.Contains([Name], "Ventes"))
```

## Bonnes pratiques

1. **Uniformisez** la structuré des fichiers
2. **Nommez** les fichiers de manière cohérente
3. **Testez** avec quelques fichiers d'abord
4. **Actualisez** régulièrement

## Avantages

- Automatisation complete
- Nouveau fichier = automatiquement inclus
- Transformations reproductibles
- Pas de formules complexes

[Découvrir nos formations Excel](/formations-excel)
