---
title: "Excel Power Pivot : Modelisation de Donnees et DAX"
date: "2024-07-02"
author: "Thomas L'Exceleur"
excerpt: "Maitrisez Power Pivot pour la modelisation de donnees et le DAX."
description: "Guide complet Power Pivot pour la modelisation et les formules DAX."
category: "Power Pivot"
categories: ["Power Pivot", "Analyse de donnees Excel"]
tags: ["Power Pivot", "DAX", "Modelisation", "Excel"]
---

# Power Pivot : Modelisation de Donnees et DAX

Power Pivot transforme Excel en outil d'analyse de donnees avance.

## Activer Power Pivot

### Etapes

1. **Fichier** > **Options** > **Complements**
2. Gerer : Complements COM > **OK**
3. Cochez **Microsoft Power Pivot for Excel**

### Acceder

Onglet **Power Pivot** dans le ruban.

## Le modele de donnees

### Concept

Un modele de donnees est un ensemble de tables reliees entre elles.

### Avantages

- Gerer des millions de lignes
- Relations entre tables
- Formules DAX puissantes

## Ajouter des tables

### Depuis Excel

1. Selectionnez les donnees
2. **Power Pivot** > **Ajouter au modele de donnees**

### Depuis Power Query

Chargez vers le modele de donnees.

## Creer des relations

### Vue Diagramme

1. **Power Pivot** > **Gerer**
2. **Affichage** > **Vue Diagramme**
3. Glissez les champs pour creer des relations

### Types de relations

| Type | Description |
|------|-------------|
| Un a plusieurs (*) | Le plus courant |
| Un a un | Cas specifiques |

## Introduction au DAX

### Qu'est-ce que DAX ?

Data Analysis Expressions - langage de formules pour Power Pivot.

### Mesures vs Colonnes calculees

| Mesures | Colonnes calculees |
|---------|-------------------|
| Calculees a la volee | Calculees a l'import |
| Contexte de filtre | Contexte de ligne |
| Non stockees | Stockees dans le modele |

## Creer une mesure

### Etapes

1. Dans Power Pivot, selectionnez une table
2. Zone de mesure (bas de l'ecran)
3. Entrez la formule

### Syntaxe

```dax
Nom_Mesure := FONCTION(arguments)
```

## Fonctions DAX essentielles

### Agregations

```dax
Total Ventes := SUM(Ventes[Montant])
Moyenne := AVERAGE(Ventes[Montant])
Nombre := COUNT(Ventes[ID])
Distinct := DISTINCTCOUNT(Ventes[Client])
```

### CALCULATE

Modifie le contexte de filtre.

```dax
Ventes France := CALCULATE(
    SUM(Ventes[Montant]);
    Ventes[Pays]="France"
)
```

## Time Intelligence

### Fonctions temporelles

| Fonction | Description |
|----------|-------------|
| TOTALYTD | Cumul depuis debut d'annee |
| SAMEPERIODLASTYEAR | Meme periode annee precedente |
| DATEADD | Decaler une periode |
| DATESYTD | Dates depuis debut d'annee |

### Exemples

```dax
YTD := TOTALYTD(SUM(Ventes[Montant]); Calendrier[Date])

Annee Precedente := CALCULATE(
    SUM(Ventes[Montant]);
    SAMEPERIODLASTYEAR(Calendrier[Date])
)
```

## Table Calendrier

### Pourquoi ?

Necessaire pour les calculs temporels.

### Creer une table calendrier

```dax
Calendrier = CALENDAR(DATE(2020;1;1); DATE(2025;12;31))
```

### Ajouter des colonnes

```dax
Annee = YEAR(Calendrier[Date])
Mois = FORMAT(Calendrier[Date]; "MMMM")
Trimestre = "T" & QUARTER(Calendrier[Date])
```

## Utiliser dans les TCD

### Ajouter des mesures

Les mesures apparaissent dans la liste des champs du TCD.

### Avantage

Les mesures sont calculees selon le contexte du TCD.

## Bonnes pratiques

| Pratique | Description |
|----------|-------------|
| Nommage | Noms clairs et coherents |
| Documentation | Commentez les mesures complexes |
| Performance | Evitez les colonnes calculees inutiles |
| Test | Verifiez avec des valeurs connues |

## Erreurs courantes

| Erreur | Cause | Solution |
|--------|-------|----------|
| Valeur vide | Division par zero | Utilisez DIVIDE() |
| #ERROR | Syntaxe incorrecte | Verifiez la formule |
| Resultat faux | Contexte mal compris | Analysez le contexte |

[Decouvrir nos formations Excel](/formations-excel)
